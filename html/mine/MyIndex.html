<!DOCTYPE html>
  <html>
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
      <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
      <title>我的主页</title>
      <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
      <link rel="stylesheet" type="text/css" href="../../css/style.css"/>
      <style>
          /*主页头部*/
          header{position: absolute; top: 0; padding: 0 14px; height: 168px; width: calc(100% - 28px);}
          .bg-index{position: absolute; top: 0; left: 0; width: 100%; height: 100%;}
          .top{position: relative; height: 44px; line-height: 44px; z-index: 2;}
          .top em{width: 40px; height: 44px; background: url(../../image/back1.png) no-repeat left 12px; background-size: 10px 17px;
          float: left;}
          .top span{width: 40px; height: 44px; background: url(../../image/more2.png) no-repeat right 12px; background-size: 4px 17px;
           float: right;}
          .top i{width: 18px; height: 44px; background: url(../../image/msg3.png) no-repeat 0 12px; background-size: 18px;
           float: right;}
          .bg-color{position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,.6);
          opacity: 0.6}
          .i-info{margin-top: 20px; margin-bottom: 36px; z-index: 2px; color: #fff;}
          .i-pic{border: 2px solid #fefefe; width: 63px; height: 63px; border-radius: 50%; overflow: hidden; z-index: 2;}
          .i-pic img{width: 100%; height: 100%;}
          .i-menu{z-index: 2; margin-left: 10px;}
          .i-name{font-size: 18px; line-height: 20px; padding-bottom: 4px;}
          .i-nav{font-size: 14px; line-height: 20px;}
          .i-nav span{margin-right: 5px;}
          /*Tab选项头部*/
          .Tab-top{position: fixed; top: 0; height: 44px; line-height: 44px; z-index: 99;
          font-size: 18px; background-color: #fefefe; padding:0 14px; color: #232528; width: calc(100% - 28px);}
          .Tab-top em{height: 44px; background: url(../../image/back.png) no-repeat left 12px; background-size: 10px 17px;
          float: left; padding-left: 30px;}
          .Tab-top span{width: 40px; height: 44px; background: url(../../image/more3.png) no-repeat right 12px; background-size: 4px 17px;
          float: right;}
          .Tab-top i{width: 18px; height: 44px; background: url(../../image/msg2.png) no-repeat right 12px; background-size: 18px;
          float: right;}

          .navMenu{background-color: #fefefe; border-bottom: 1px solid #eeeff7; margin-top: 168px; width: 100%; z-index: 99;}
          .navMenu a{flex:1px; -webkit-flex:1; -webkit-flex-box:1; text-align: center;}
          .navMenu span{ font-size:16px; color: #999; padding: 12px 0; border-bottom: 2px solid #fefefe;}
          .navMenu span.on{border-bottom: 2px solid #ffc708;}

          /*动态*/
          .cir-container,.Fans-container{margin-top: 10px;}
          .cirlist .cir-box{background: #fefefe; margin-bottom: 10px;}
          .cirlist:last-child .cir-box{margin-bottom: 0;}
          .cir-container .cir-title{padding: 14px 14px 0 14px; display: -webkit-box;display: -ms-flexbox;display: -webkit-flex;
            display: flex; -webkit-box-align: center;-ms-flex-align: center;-webkit-align-items: center;align-items: center;
           margin-bottom: 8px;}
          .cir-title img{width: 36px; height: 36px; border-radius: 50%;}
          .cir-title .cir-info{margin-left: 12px; -webkit-box-flex: 1;-webkit-flex: 1;flex: 1;}
          .cir-name{font-size: 15px; line-height: 20px; letter-spacing: 2px;}
          .cir-time{font-size: 12px; line-height: 20px; letter-spacing: 1px; color: #ced1d5;}
          .cir-rt .down-arrow{display: inline-block; width: 16px; height: 10px; background: url(../../image/down-arrow.png) no-repeat center;
          background-size: contain; margin-left: 10px;}
          .cir-content{line-height: 25px; font-size: 17px; padding: 0 14px 7px 14px;}

          /*九宫格*/
          .cell {padding:0 14px;max-width: 210px;max-height: 210px;overflow: hidden;padding-bottom: 10px;}
          .cell img { width: 100%; height: 100%;}
          .cell9 {padding:0 7px;width: calc(100% - 14px);overflow: hidden;}
          .cell9 .item { width: calc(33.33% - 14px); float: left; margin: 0 7px 14px 7px; position: relative; }
          .cell9.cell4 .item {width: calc(50% - 14px);}
          .cell9 .item:before {content: "";display: inline-block;padding-bottom: 100%;width: 0.1px;vertical-align: middle;}
          .cell9 .item img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
          /*视频*/
          .bad-video{margin:0 14px 14px 14px; position: relative; height: 200px;}
          .videoPlay{position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); height: 58px;}
          .video{ width:100%; height:100%;}
          .video-num{color: #fff; font-size: 13px; letter-spacing: 2px; position: absolute; right: 10px; bottom: 13px;}

          /*活动*/
          .act-list li{background: #fefefe; padding: 14px; margin-bottom: 10px;}
          .act-top{position: relative; }
          .act-top .open-icon{position: absolute; top: 0; right: 0;background: url(../../image/down-arrow.png) no-repeat center;
          background-size: contain;  width: 15px; height: 10px;}
          .act-toplf{width: calc(100% - 40px);}
          .act-title{font-size: 16px; line-height: 20px;}
          .act-title em{width: 15px; height: 15px; background: url() no-repeat center; background-size: contain;
          vertical-align: middle; margin-left: 8px;}
          .act-title em.one{background: url(../../image/r1.png) no-repeat center; background-size: contain;}
          .act-title em.two{background: url(../../image/r2.png) no-repeat center; background-size: contain;}
          .act-title em.three{background: url(../../image/r3.png) no-repeat center; background-size: contain;}
          .act-time{font-size: 13px; line-height: 20px; color: #ced1d5;}
          .act-info{padding: 5px; background-color: #e9eaf1; border-radius: 2px;}
          .act-info img{width: 53px; height: 53px; float: left;}
          .act-rtinfo{width: calc(100% - 73px); margin: 0 10px; font-size: 15px; color: #666; line-height: 24px;
          float: left;}

          /*粉丝*/
          .fans-list li{background-color: #fefefe; padding: 14px; box-shadow: inset 0px -1px 0px 0px #d2d3d5;}
          .fans-pic{width: 45px; height: 45px; border-radius: 50%; overflow: hidden; margin-right: 18px;}
          .fans-pic img{width: 100%; min-height: 45px;}
          .fans-info{flex: 1; -webkit-flex:1; -webkit-flex-box:1;}
          .fans-name{font-size: 16px; line-height: 20px;}
          .fans-num{font-size: 13px; color: #999;}
          .fans-btn,.follow-btn{min-width: 62px; height: 30px; border: solid 1px #ffc708; border-radius: 2px;
          font-size: 15px; color: #ffc708;}
          .fans-btn.on,.follow-btn.on{color: #ccc; border: solid 1px #ccc;}

          .slideNormal{
              -webkit-transition: all 100ms;
              -o-transition: 100ms;
              transition: 100ms;
          }

          /*与他人互动动态*/
          .bg-love{background-color: #e9eaf1; border-radius: 4px; padding: 4px; overflow: hidden; margin: 0 14px;}
          .love-img{width: 54px; height: 54px; overflow: hidden; margin-right: 10px;}
          .love-img img{width: 100%; height: 100%;}
          .love-cotent{font-size: 15px; line-height: 20px; color: #666; width: calc(100% - 64px);}
          .love-cotent.on{width: 100%;}
          .addpd{padding-bottom: 14px;}


      </style>
  </head>
  <body>
    <div id="app" class="wrap" v-cloak>
        <!-- 主页头部 -->
        <header id="index-top" class="slideNormal" v-show="showtop == 1">
            <div class="top">
                <em tapmode onclick="go_back()"></em>
                <span></span>
                <i tapmode @click="goChat(infodata)" v-show="isme == false"></i>
            </div>
            <div class="i-info flex-align-center">
                <div class="i-pic">
                    <img :src="infodata.headimgurl+'?x-oss-process=image/resize,m_fill,h_63,w_63'" alt="人头像" v-if="infodata.headimgurl" tapmode @click="viewPicture(infodata.headimgurl,0)">
                    <img src="../../image/pic.png" alt="人头像" v-else>
                </div>
                <div class="i-menu">
                    <p class="i-name">{{infodata.nickname}}</p>
                    <p class="i-nav">
                      <span>关注 {{info.follower_count}}</span>
                      <span>粉丝 {{info.fans_count}}</span>
                      <!-- checkstatus 1 已经关注 0 未关注-->
                      <button class="follow-btn" v-show="isme == false && checkstatus == '0'" tapmode @click="follow('',1)">关注</button>
                      <button class="follow-btn on" v-show="isme == false && checkstatus == '1'" tapmode @click="follow('',0)">已关注</button>
                    </p>
                </div>
            </div>
            <img class="bg-index" :src="infodata.headimgurl" alt="人头像" v-if="infodata.headimgurl">
            <img class="bg-index" src="../../image/img1.jpg" alt="主页背景图" v-else>
            <div class="bg-color"></div>
        </header>

        <!-- Tab选项头部 -->
        <div class="Tab-top slideNormal" id="Tab-top" v-show="showtop == 2">
            <em tapmode onclick="go_back()">{{infodata.nickname}}</em>
            <span></span>
            <i tapmode @click="goChat(infodata)" v-show="isme == false"></i>
        </div>

        <div class="navMenu flex-center">
            <a href="javascript:;" v-for="(item,index) in tabData" tapmode @click="switchTab(index)">
    					<span :class="{on:changeColor == index}">{{item.tabName}}</span>
    				</a>

        </div>
        <div class="main">

          <!-- 用户发表的学科圈 -->
          <div class="cir-container" v-if="changeColor == 0">
              <!-- 没有动态 -->
              <div class="no-data" v-if="data.status">
                   <img src="../../image/ndata.png" alt="没数据图片">
                   <p>抱歉，没有数据~</p>
              </div>

              <div class="cirlist" v-for="(v,index) in data" v-else>
                  <!-- 新鲜事互动动态 -->
                  <div class="cir-box addpd" v-if="v.id">
                      <div class="cir-title">
                          <img :src="infodata.headimgurl+'?x-oss-process=image/resize,m_fill,h_36,w_36'" alt="人头像" v-if="infodata.headimgurl">
                          <img src="../../image/pic.png" alt="人头像" v-else>
                          <div class="cir-info">
                              <p class="cir-name">{{infodata.nickname}}</p>
                              <p class="cir-time">{{v.time | getInfoDate}}</p>
                          </div>
                          <div class="cir-rt" v-show="isme == true">
                              <span class="down-arrow" tapmode @click="showMenu(v,index,3)"></span>
                          </div>
                      </div>
                      <div class="cir-content" tapmode @click="circleDetail(v.id,1)">
                          {{v.comments}}
                      </div>
                      <div class="bg-love flex-align-center" tapmode @click="circleDetail(v.id,1)">
                          <div class="love-img">
                              <img :src="v.surface_plot+'?x-oss-process=image/resize,m_fill,h_54,w_54'" alt="图片" v-if="v.surface_plot">
                          </div>
                          <div class="love-cotent more">
                              {{v.title}}
                          </div>
                      </div>
                  </div>
                  <!-- 与他人动态互动 -->
                  <div class="cir-box addpd" v-else-if="v.ccl_rew">
                      <div class="cir-title">
                          <img :src="infodata.headimgurl+'?x-oss-process=image/resize,m_fill,h_36,w_36'" alt="人头像" v-if="infodata.headimgurl">
                          <img src="../../image/pic.png" alt="人头像" v-else>
                          <div class="cir-info">
                              <p class="cir-name">{{infodata.nickname}}</p>
                              <p class="cir-time">{{v.time | getInfoDate}}</p>
                          </div>
                          <div class="cir-rt" v-show="isme == true">
                              <span class="down-arrow" tapmode @click="showMenu(v,index,2,'circle')"></span>
                          </div>
                      </div>
                      <div class="cir-content" tapmode @click="circleDetail(v.ccl_id,2)">
                          {{v.ccl_rew}}
                      </div>
                      <div class="bg-love flex-align-center" tapmode @click="circleDetail(v.ccl_id,2)">
                          <div class="love-img" v-if="v.thumb">
                              <img :src="v.thumb[0]+'?x-oss-process=image/resize,m_fill,h_54,w_54'" alt="图片" v-if="v.thumb">
                          </div>
                          <div class="love-cotent more">
                              {{v.ccl_content}}
                          </div>
                      </div>
                  </div>
                  <!-- 个人动态 -->
                  <div class="cir-box" v-else>
                      <div class="cir-title">
                        <img :src="infodata.headimgurl+'?x-oss-process=image/resize,m_fill,h_36,w_36'" alt="人头像" v-if="infodata.headimgurl">
                        <img src="../../image/pic.png" alt="人头像" v-else>
                          <div class="cir-info">
                              <p class="cir-name">{{infodata.nickname}}</p>
                              <p class="cir-time">{{v.time | getInfoDate}}</p>
                          </div>
                          <div class="cir-rt" v-show="isme == true">
                              <span class="down-arrow" tapmode @click="showMenu(v,index,1,'circle')"></span>
                          </div>
                      </div>
                      <div class="cir-content" tapmode @click="circleDetail(v.ccl_id,2)">
                          {{v.content}}
                      </div>
                      <div  tapmode @click="circleDetail(v.ccl_id,2)" v-if="v.thumb">
                          <!-- 1张图片 -->
                          <ul class="cell clearfix" v-if="v.thumb.length == 1">
                               <li class="item" tapmode>
                                  <img :src="v.thumb[0]+'?x-oss-process=image/resize,m_fill,h_210,w_210'" alt="动态图">
                               </li>

                          </ul>

                          <!-- 4宫格图片 -->
                          <ul class="cell9 cell4 clearfix" v-else-if="v.thumb.length == 4">
                               <li class="item" v-for="(item,index) in v.thumb">
                                  <img :src="item+'?x-oss-process=image/resize,m_fill,h_180,w_180'" alt="动态图">
                               </li>

                          </ul>

                          <!-- 9宫格图片 -->
                          <ul class="cell9 clearfix" v-else>
                               <li class="item" v-for="(item,index) in v.thumb">
                                  <img :src="item+'?x-oss-process=image/resize,m_fill,h_180,w_180'" alt="动态图">
                               </li>

                          </ul>
                      </div>
                  </div>
              </div>
          </div>

          <!-- 活动 -->
          <div class="act-container" v-else-if="changeColor == 1">
              <div class="no-data" v-if="actdata.status">
                   <img src="../../image/ndata.png" alt="没数据图片">
                   <p>抱歉，没有数据~</p>
              </div>
              <ul class="act-list" v-else>
                  <li v-for="v in actdata">
                      <div class="act-top">
                          <div class="act-toplf">
                              <p class="act-title">
                                {{v.content}}
                                <!-- <em class="on"></em> -->
                              </p>
                              <p class="act-time">{{v.time | getInfoDate}}</p>
                          </div>
                          <em class="open-icon" v-show="isme == true" tapmode @click="showMenu(v,index,'','active')"></em>
                      </div>
                      <div class="act-info clearfix" tapmode @click="ActDetail(v.act_id)">
                          <img :src="v.actimgurl+'?x-oss-process=image/resize,m_fill,h_45,w_45'" alt="活动图片" v-if="v.actimgurl">
                          <img src="../../image/img.jpg" alt="活动图片" v-else>
                          <div class="act-rtinfo more">
                              {{v.title}}
                          </div>
                      </div>
                  </li>
              </ul>

          </div>

          <!-- 粉丝 -->
          <div class="Fans-container" v-else-if="changeColor == 2 || changeColor == 3">
              <div class="no-data" v-if="fansdata.status">
                   <img src="../../image/ndata.png" alt="没数据图片">
                   <p>抱歉，没有数据~</p>
              </div>
              <ul class="fans-list" v-else>
                  <li class="flex-align-center" v-for="(v,index) in fansdata">
                      <!-- //followstutas类型 获取粉丝 ： 0 获取关注的人 ： 1 -->
                      <div class="fans-pic" tapmode @click="userIndex(v.user_id)" v-if="followstutas == '0'">
                          <img :src="v.headimgurl+'?x-oss-process=image/resize,m_fill,h_45,w_45'" alt="人头像" v-if="v.headimgurl">
                          <img src="../../image/pic.png" alt="人头像" v-else>
                      </div>
                      <div class="fans-pic" tapmode @click="userIndex(v.follower_id)" v-else>
                          <img :src="v.headimgurl+'?x-oss-process=image/resize,m_fill,h_45,w_45'" alt="人头像" v-if="v.headimgurl">
                          <img src="../../image/pic.png" alt="人头像" v-else>
                      </div>
                      <div class="fans-info" tapmode @click="userIndex(v.user_id)" v-if="followstutas == '0'">
                          <p class="fans-name">
                              {{v.nickname}}
                          </p>
                          <p class="fans-num" v-if="v.count != '0'">
                              {{v.count}}人关注
                          </p>
                          <p class="fans-num" v-else>
                              快来关注他吧
                          </p>
                      </div>
                      <div class="fans-info" tapmode @click="userIndex(v.follower_id)" v-else>
                          <p class="fans-name">
                              {{v.nickname}}
                          </p>
                          <p class="fans-num" v-if="v.count != '0'">
                              {{v.count}}人关注
                          </p>
                          <p class="fans-num" v-else>
                              快来关注他吧
                          </p>
                      </div>
                      <!-- 加class on 为已关注-->
                      <!--   is_follow 1 已关注 0 未关注 -->
                      <!-- //followstutas类型 获取粉丝 ： 0 获取关注的人 ： 1 -->
                      <button class="fans-btn" tapmode @click="follow(v,1)" v-if="v.is_follow == '0'">关注</button>
                      <button class="fans-btn on" v-else-if="v.is_follow == '1' && isme == false">已关注</button>
                      <button class="fans-btn on" tapmode @click="follow(v,0)" v-else>已关注</button>

                  </li>

              </ul>
          </div>
        </div>
    </div>

    <!-- 弹窗 -->
    <div class="Popup" tapmode>
        <ul class="handleMenu">
            <li tapmode onclick="Delete()">删除</li>
        </ul>
    </div>
  </body>
  <script type="text/javascript" src="../../script/api.js"></script>
  <script type="text/javascript" src="../../script/my.js"></script>
  <script type="text/javascript" src="../../script/vue.js"></script>
  <script type="text/javascript" src="../../script/date.js"></script>
  <script type="text/javascript">
      var token,id,uid,page=1;
      apiready = function(){
        api.parseTapmode();//解析元素 tapmode 属性，优化点击事件处理
        token = api.getPrefs({
            sync: true,
            key: 'token'
        });
        uid = api.getPrefs({
            sync: true,
            key: 'id'
        });
        if (api.pageParam.id) {
            id = api.pageParam.id;

            if (id != uid) {
               vm.isme = false;

            }
        }else {
            id = api.getPrefs({
                sync: true,
                key: 'id'
            });
        }
        vm.getUser();
        vm.switchTab(0);
        vm.checkfollow();

        var Popup = $api.dom('.Popup');
        Popup.ontouchstart = function(event){
          if(event.target == this){
            $api.css($api.dom('.Popup'), 'display:none');
          }
        }

      }

      var vm = new Vue({
        el: '#app',
        data: {
            data: [],
            actdata: [],
            fansdata: [],
            circleLen: '',
            tabData: [{ tabName: '动态' }, { tabName: '活动' }, { tabName: '粉丝' }, { tabName: '关注' }],
            changeColor: 0,
            loadata: true, // 设置一个开关来避免重负请求数据
            updata: false,
            showtop: 1,
            info: [],
            infodata: [],
            isme: true,
            followstutas: '',
            checkstatus: '',
            type: '',
            index: '',
            Deltype: '',
            itemcircle: []
        },
        filters: {
            getInfoDate: function getInfoDate(time) {
                return getDate(time);
            }
        },
        methods: {
            // 导航切换
            switchTab: function switchTab(index) {
                vm.changeColor = index;

                if (index == 1) {
                    vm.getAct(page);
                } else if (index == 2) {

                    vm.getFans(0, page);
                } else if (index == 3) {

                    vm.getFans(1, page);
                } else {
                    vm.trends();
                }
            },
            userIndex: function userIndex(user_id) {

                if (uid != user_id) {
                    vm.isme = false;
                    id = user_id;
                    vm.getUser();
                    vm.switchTab(vm.changeColor);
                    vm.checkfollow();
                }
            },
            // 弹窗
            showMenu: function showMenu(item, index, type, Deltype) {
                $api.css($api.dom('.Popup'), 'display:block');
                vm.itemcircle = item;
                vm.index = index;
                vm.type = type;
                vm.Deltype = Deltype;
            },
            ActDetail: function ActDetail(actid) {
                openWin('actDetail', '../active/actDetail.html', { actid: actid });
            },
            goChat:function goChat(item){

                 openWin('chat','../chat/chat.html',{peer:item.id,nickname:item.nickname,headimgurl:item.headimgurl});
            },
            circleDetail: function circleDetail(cirid, index) {
                if (index == 2) {
                    openWin('circleDetail2', '../circle/circleDetail2.html', { cirid: cirid });
                } else {
                    openWin('circleDetail1', '../circle/circleDetail1.html', { newid: cirid });
                }
            },
            // 查看大图
            viewPicture: function viewPicture(data, index) {

                if (data) {
                    var url = [];

                    if (data instanceof Array) {
                        data.forEach(function (ret) {
                            url.push(ret);
                        });
                    } else {
                        url.push(data);
                    }

                    var imageBrowser = api.require('imageBrowser');
                    imageBrowser.openImages({
                        imageUrls: url,
                        showList: false,
                        activeIndex: index
                    });
                }
            },
            //个人动态
            trends: function trends() {
                showProgress('努力加载中', '请稍后···');
                api.ajax({
                    url: serverurl,
                    method: 'get',
                    data: {
                        values: {
                            type: '10076',
                            uid: id
                        }

                    }
                }, function (ret, err) {
                    api.hideProgress();

                    if (ret) {

                        if (ret.status == '5') {

                            ExitLogin();
                        } else {

                            vm.data = ret;
                        }
                    } else {

                        msg('网络错误');
                    }
                });
            },

            //检测用户是否关注对方
            checkfollow: function checkfollow() {
                showProgress('努力加载中', '请稍后···');
                api.ajax({
                    url: serverurl,
                    method: 'get',
                    data: {
                        values: {
                            type: '10086',
                            token: token,
                            uid: uid,
                            follower_id: id
                        }

                    }
                }, function (ret, err) {
                    api.hideProgress();

                    if (ret) {

                        if (ret.status == '5') {

                            ExitLogin();
                        } else {

                            vm.checkstatus = ret.status;
                        }
                    } else {

                        msg('网络错误');
                    }
                });
            },

            //用户关注/粉丝列表
            getFans: function getFans(index, page) {
                showProgress('努力加载中', '请稍后···');
                vm.followstutas = index;
                if (vm.isme == true) {
                    var other_id = '';
                } else {
                    var other_id = uid;
                }

                api.ajax({
                    url: serverurl,
                    method: 'get',
                    data: {
                        values: {
                            type: '10073',
                            uid: id,
                            form: index, //类型 获取粉丝 ： 0 获取关注的人 ： 1
                            limit: page,
                            other_id: other_id
                        }

                    }
                }, function (ret, err) {
                    api.hideProgress();

                    if (ret) {

                        if (ret.status == '5') {

                            ExitLogin();
                        } else {

                            vm.fansdata = ret;
                        }
                    } else {

                        msg('网络错误');
                    }
                });
            },

            //个人中心的活动
            getAct: function getAct(page) {
                showProgress('努力加载中', '请稍后···');

                api.ajax({
                    url: serverurl,
                    method: 'get',
                    data: {
                        values: {
                            type: '10075',
                            user_id: id
                        }

                    }
                }, function (ret, err) {
                    api.hideProgress();

                    if (ret) {

                        if (ret.status == '5') {

                            ExitLogin();
                        } else {

                            vm.actdata = ret;
                        }
                    } else {

                        msg('网络错误');
                    }
                });
            },

            upSwiper: function upSwiper() {
                window.onscroll = function () {
                    var t = document.documentElement.scrollTop || document.body.scrollTop; //获取距离页面顶部的距离

                    var uptop = document.getElementById("index-top"); //获取div元素
                    var fixtop = document.getElementById("Tab-top"); //获取div元素
                    var navMenu = $api.dom('.navMenu');
                    var main = $api.dom('.main');

                    if (t >= 168) {
                        //当距离顶部超过168px时
                        vm.showtop = 2;
                        navMenu.style.cssText = 'position:fixed; top:44px; margin-top:0;';
                        main.style.cssText = 'margin-top:272px;';
                    } else {
                        //如果距离顶部小于168px
                        vm.showtop = 1;
                        navMenu.style.cssText = 'margin-top:168px';
                        main.style.cssText = 'margin-top:0;';
                    }
                };
            },
            //获取用户基本信息
            getUser: function getUser() {

                api.ajax({
                    url: serverurl,
                    method: 'get',
                    cache: true,
                    data: {
                        values: {
                            type: '10035',
                            uid: id
                        }
                    }
                }, function (ret, err) {

                    if (ret) {
                        if (ret.status == '5') {
                            ExitLogin();
                        } else {

                            vm.info = ret;
                            vm.infodata = ret.data;
                        }
                    } else {
                        msg('网络错误');
                    }
                });
            },

            //用户关注
            follow: function follow(item, status) {
                var time = Math.round(new Date().getTime() / 1000);
                //followstutas类型 获取粉丝 ： 0 获取关注的人 ： 1
                if (!item) {
                    var follower_id = id;
                } else {
                    if (vm.followstutas == 0) {
                        var follower_id = item.user_id;
                    } else if (vm.followstutas == 1) {
                        var follower_id = item.follower_id;
                    }
                }

                showProgress('努力加载中', '请稍后···');
                api.ajax({
                    url: serverurl,
                    method: 'get',
                    data: {
                        values: {
                            type: '10072',
                            uid: uid,
                            token: token,
                            follower_id: follower_id,
                            time: time,
                            status: status //关注 ： 1 取消关注 ：0
                        }
                    }
                }, function (ret, err) {
                    api.hideProgress();

                    if (ret) {
                        if (ret.status == '5') {
                            ExitLogin();
                        } else if (ret.status == '0') {
                            msg('操作失败');
                        } else {
                            if (!item) {
                                //<!-- checkstatus 1 已经关注 0 未关注-->
                                if (status == 1) {
                                    //关注 ： 1 取消关注 ：0
                                    vm.checkstatus = 1;
                                } else {
                                    vm.checkstatus = 0;
                                }
                            } else {
                                //status 1 已关注 0 未关注
                                if (status == 1) {
                                    //关注 ： 1 取消关注 ：0
                                    item.is_follow = 1;
                                } else {
                                    item.is_follow = 0;
                                }
                                item.count = ret.count;
                            }
                        }
                    } else {
                        msg('网络错误');
                    }
                });
            }

        },

        mounted: function mounted() {
            this.upSwiper();
        }
    });

    //  删除动态
    function Delete(){
         if (vm.Deltype == 'circle') {
              DelCircle();
         }else {
              DelAct();
         }
    }

    // 删除动态
    function DelCircle(){
      showProgress('努力加载中','请稍后···');
      if (vm.itemcircle.ccl_id) {
          var cirid = vm.itemcircle.ccl_id;
      }else {
          var cirid = vm.itemcircle.id;
      }

      api.ajax({
          url: serverurl,
          method: 'get',
          data: {
              values: {
                  type: '10085',
                  token: token,
                   uid: uid,
                   form: vm.type,//类型 1:自己发表的学客圈 2:学客圈的评论 3:对官方文章的评论
                   id:cirid
              }
          }
      },function(ret, err){
          api.hideProgress();
          $api.css($api.dom('.Popup'), 'display:none');
          if (ret) {

              if (ret.status == '5') {
                  ExitLogin();
              }else if(ret.status == '0'){
                  msg('操作失败');

              }else {
                var newData = vm.data.del(vm.index);
                vm.data = newData;

              }
          } else {
              msg('网络错误');
          }
      });

    }

    //删除活动动态
    function DelAct(){
      showProgress('努力加载中','请稍后···');

      api.ajax({
          url: serverurl,
          method: 'get',
          data: {
              values: {
                  type: '10090',
                  token: token,
                   uid: uid,
                   id:vm.itemcircle.id
              }
          }
      },function(ret, err){
          api.hideProgress();
          $api.css($api.dom('.Popup'), 'display:none');

          if (ret) {

              if (ret.status == '5') {
                  ExitLogin();
              }else if(ret.status == '0'){
                  msg('操作失败');

              }else {
                var newData = vm.actdata.del(vm.index);
                vm.actdata = newData;

              }
          } else {

              msg('网络错误');
          }
      });

    }
  </script>
  </html>
