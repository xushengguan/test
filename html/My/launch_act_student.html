<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>我发起的活动（学生家长）</title>
	<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
	<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
	<link rel="stylesheet" href="../../css/api.css">
	<link rel="stylesheet" href="../../css/common.css">
	<link rel="stylesheet" type="text/css" href="../../css/aui.css" />
	<link rel="stylesheet" href="../../icon/iconfonts/iconfont.css">
	<link rel="stylesheet" href="../../css/7startAct.css">
</head>

<body>
	<div id="app">
		<div class="startAct-con" v-for='v in data'>
			<div class="match-con hide">
				<div class="fl">
					<h5>{{v.title}}</h5>
					<h6>{{v.class + v.subject + v.section}}</h6>
				</div>
				<p class="fr">
					<span class="match-date">{{v.time | formatDate}}</span>
					<span>人数:{{v.num}}人</span>
				</p>
			</div>
		</div>
	</div>

</body>

</html>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/my.js"></script>
<script type="text/javascript" src="../../script/aui-toast.js"></script>
<script type="text/javascript" src="../../script/vue.js"></script>
<script type="text/javascript" src="../../script/date.js"></script>
<script type="text/javascript">
	var vm = new Vue({
		el: '#app',
		data: {
			id: '',
			data: [],
		},
		filters: {
			formatDate(time) {
				var date = new Date(time * 1000);
				return formatDate(date, 'yyyy-MM-dd');
			}
		},
		methods: {
			get_userAct() { //获取用户发表的活动
				api.ajax({
					url: serverurl,
					method: 'get',
					dataType: 'json',
					data: {
						values: {
							type: '10017',
							uid: vm.id
						}
					}
				}, function(ret, err) {
					if (ret) {
						if (ret.status == '1') {
							vm.data = ret.data;
						} else {
							api.toast({
								msg: '网络错误',
								duration: 2000,
								location: 'middle'
							});

						}
					} else {
						api.toast({
							msg: '网络错误',
							duration: 2000,
							location: 'middle'
						});
					}
				});
			}
		},

	})

	apiready = function() {
		vm.id = api.pageParam.id;
		var toast = new auiToast();
		toast.loading({
			title: "加载中",
			duration: 2000
		}, function(ret) {
			vm.get_userAct();
			toast.hide();
		});

		//刷新
		api.setRefreshHeaderInfo({
			loadingImg: 'widget://image/refresh.png',
			bgColor: '#444',
			textColor: '#fff',
			textUp: '释放立即刷新...',
			textLoading: '加载中···',
			showTime: false
		}, function(ret, err) {
			//在这里从服务器加载数据，加载完成后调用api.refreshHeaderLoadDone()方法恢复组件到默认状态
			toast.loading({
				title: "加载中",
				duration: 2000
			}, function(ret) {
				vm.get_userAct();
				toast.hide();
			});
			api.refreshHeaderLoadDone();
		});

	}
</script>
