<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <link rel="stylesheet" href="../../css/api.css">
    <link rel="stylesheet" href="../../css/common.css">
		<link rel="stylesheet" href="../../css/loading.css">
    <link rel="stylesheet" href="../../icon/iconfonts/iconfont.css">
    <link rel="stylesheet" href="../../css/3creatAct3.css">

</head>
<body>
	<div class="creatAct2">
		<header class="creatAct-header login2">
			<i class="iconfont icon-fanhui icon-back" onclick="go_back()"></i>
			<div class="headerAct-con hide">
				<div class="headerAct-left fl">
					<span>参加活动</span>
					<span>Participate in the Activity</span>
				</div>
				<span class="img-head01 fr"><img src="../../image/head01.png" alt="" class="img-size"></span>
			</div>
		</header>
		<div class="creatAct3-con">
			<input type="text" placeholder="请输入活动口令" style="color:#4f4f4f;" id="Password">
			<div class="hide wordCommand">
				<p class="fl" id="tip" style="display:none">
					<i class="iconfont icon-jingshi icon-warn"></i>
					<span class="commandNo">口令不存在</span>
				</p>
				<p class="sweep-code fr">
					<i class="iconfont icon-erweima icon-code"></i>
					<span>扫描二维码</span>
				</p>
			</div>
			<p class="creatAct2-btns">
				<button class="connection login-btn" onclick="sureJoin()">确认</button>
			</p>
		</div>
	</div>
</body>
</html>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/my.js"></script>
<script type="text/javascript">
      var id;
			apiready = function(){
				loading();
				id = api.pageParam.id;
				var headimgurl = api.pageParam.headimgurl;
				if (headimgurl !== '' && headimgurl !== null) {
						$api.attr($api.dom('.img-head01 img'), 'src', headimgurl);
				}
			}

			//确认参加活动跳到活动房间
			function sureJoin(){
					var command = $api.val($api.dom('#Password'));
          if (command == '') {
							Tips('#tip','请输入口令');
							return false;
          }
					$api.css($api.dom('#loading'), 'display:block');
					api.ajax({//参加活动
					    url: serverurl,
					    method: 'post',
							dataType:'json',
					    data: {
					        values: {
					            type: '10016',
											command:command,
											uid:id,
					        }
					    }
					},function(ret, err){
							$api.css($api.dom('#loading'), 'display:none');
					    if (ret) {
					        if (ret.status == '1') {
										api.openWin({
												name: '4promotion_exitRoom',
												url: './4promotion_exitRoom.html',
												pageParam: {
														name: 'test'
												}
										});
					        }else if (ret.status == '0') {
											Tips('#tip','口令不存在');
					        }else{
										  api.toast({
										      msg: '参加活动失败',
										      duration: 2000,
										      location: 'middle'
										  });
									}
					    } else {
					        api.toast({
					            msg: '网络错误',
					            duration: 2000,
					            location: 'middle'
					        });

					    }
					});
			}

			//错误提示
			function Tips(el,eltxt){
				$api.css($api.dom(el), 'display:block');
				$api.text($api.dom('.commandNo'), eltxt);
				setTimeout(function(){$api.css($api.dom(el), 'display:none');},2000);
			}
</script>
