<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="UTF-8">
		<title>物流信息</title>
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<link rel="stylesheet" href="../../css/api.css">
		<link rel="stylesheet" href="../../css/common.css">
		<link rel="stylesheet" href="../../css/loading.css">
		<link rel="stylesheet" href="../../icon/iconfonts/iconfont.css">
		<link rel="stylesheet" href="../../css/6goods3.css">
</head>
<body>
			<div class="delivery-bottom" id="app">
				<div class="details-con" v-for="v in data">
					<span class="dots"></span>
					<div class="delivery-right fl">
						<p class="adds">{{v.status}}</p>
						<p class="times">{{v.time}}</p>
					</div>
				</div>
			</div>
</body>
</html>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/my.js"></script>
<script type="text/javascript" src="../../script/vue.js"></script>
<script type="text/javascript">
		apiready = function(){
				var logistics_company = api.pageParam.logistics_company;
				var tracking_number = api.pageParam.tracking_number;
				loading();
				vm.getLogInfo(logistics_company,tracking_number);

				//刷新
        api.setRefreshHeaderInfo({
            loadingImg: 'widget://image/refresh.png',
            bgColor: '#444',
            textColor: '#fff',
            textUp: '释放立即刷新...',
            textLoading: '加载中···',
            showTime: false
        }, function(ret, err) {
            //在这里从服务器加载数据，加载完成后调用api.refreshHeaderLoadDone()方法恢复组件到默认状态
            vm.getLogInfo(logistics_company,tracking_number);
            api.refreshHeaderLoadDone();
        });
		}

		var vm = new Vue({
				el:'#app',
				data:{
						data:[]
				},
				methods:{
						getLogInfo(logistics_company,tracking_number){//查询物流信息
							  $api.css($api.dom('#loading'), 'display:block');
								api.ajax({
								    url: serverurl,
								    method: 'get',
								    data: {
								        values: {
								            type: '10020',
														tracking_number:tracking_number,
														logistics_company:logistics_company
								        },
								    }
								},function(ret, err){
									  $api.css($api.dom('#loading'), 'display:none');
										console.log(JSON.stringify(ret));
										console.log(JSON.stringify(err));
								    if (ret) {

												vm.data = ret.result.list;
								    } else {
								        api.toast({
								            msg: '网络错误',
								            duration: 2000,
								            location: 'bottom'
								        });

								    }
								});
						}
				}
		})
</script>
