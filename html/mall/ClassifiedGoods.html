<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0">
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/loading.css"/>
	<title>分类商品</title>
</head>

<style>

	.NoAct {
			width: 100%;
			position: absolute;
			top: 20%;
			left: 0;
			text-align: center;
			color: #333;
			font-size: 16px;
	}


	.goods_card{overflow: hidden;}
	.goods_card li{float: left; width: calc(50% - 2px); background: #fff; margin-bottom: 4px;}
	.goods_card li:nth-child(odd){margin-right: 2px;}
	.goods_card li:nth-child(even){margin-left: 2px;}
	.goods_card li img{width: 100%; height: 145px;}
	.goods_card .txt{background: #fff; padding: 8px; text-align: center;}
	.goods_card .txt .name{font-size: 14px; color: #212121; padding-bottom: 4px; font-weight: bold;}
	.goods_card .txt .abs{font-size: 12px; color: #999; padding-bottom: 4px;}
	.goods_card .txt .total{font-size: 14px; color: #f44336; font-weight: bold;}
</style>

<body>

	<div class="pro_catalog" id="app" v-cloak>
		<div class="NoAct" v-if="info == '' || info == null">抱歉，该分类暂时还没有商品！</div>
		<div v-else>
			<div class="mallBox">
					<ul class="goods_card">
							<li tapmode v-for="v in info" @click="go_goodsDetail(v.id)">
									<img :src="v.imgurl" alt="分类商品">
									<div class="txt">
											<p class="name single">{{v.goods_name}}</p>
											<p class="abs single">{{v.abs}}</p>
											<p class="total">{{v.total}}学分</p>
									</div>
							</li>
					</ul>
			</div>

		</div>
	</div>
</body>
</html>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/my.js"></script>
<script type="text/javascript" src="../../script/vue.js"></script>
<script type="text/javascript">
      apiready = function(){
					var clsid = api.pageParam.clsid;
					loading();
					vm.getClass(clsid);

					//刷新
					api.setRefreshHeaderInfo({
							loadingImg: 'widget://image/refresh.png',
							bgColor: '#efeff4',
	            textColor: '#333',
							textUp: '释放立即刷新...',
							textLoading: '加载中···',
							showTime: false
					}, function(ret, err) {
							//在这里从服务器加载数据，加载完成后调用api.refreshHeaderLoadDone()方法恢复组件到默认状态
							vm.getClass(clsid);
							api.refreshHeaderLoadDone();
					});
      };
			var vm = new Vue({
	        el: '#app',
	        data: {
							info:[],
	        },
	        methods: {
	            getClass(clsid) { //读取商品分类列表
								  $api.css($api.byId('loading'),'display:block');
	                api.ajax({
	                    url: serverurl,
	                    method: 'get',
											cache:true,
	                    dataType: 'json',
	                    data: {
	                        values: {
	                            type: '10031',
															gtypeid: clsid
	                        }
	                    }
	                }, function(ret, err) {
										  $api.css($api.byId('loading'),'display:none');
	                    vm.info = ret;
	                });
	            },

	            go_goodsDetail(goods_id){
	              api.openWin({
	                  name: 'credit_goodDetail',
	                  url: './credit_goodDetail.html',
	                  pageParam: {
	                      goods_id: goods_id
	                  },
										reload:true,
										allowEdit:true
	              });
	            },


	        }
	    })

</script>
